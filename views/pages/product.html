<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>LEATHERFORLOCAL - Sản phẩm</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="../../public/css/global.css">
    <link rel="stylesheet" href="../../public/css/style.css">
    <link rel="stylesheet" href="../../public/css/styleguide.css">
    <link rel="stylesheet" href="../../public/css/product.css">
    <script src="../../public/js/search-box.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />
    <style>
      .material-symbols-outlined {
        font-variation-settings:
          'FILL' 0,
          'wght' 400,
          'GRAD' 0,
          'opsz' 24
      }
      .cart-icon-container { 
        position: relative; 
        display: inline-block; 
      }
      .shopping-bag-preview {
        display: none;
        position: absolute;
        right: 0;
        top: 40px;
        width: 320px;
        background: #fff;
        border: 1px solid #e0e0e0;
        box-shadow: 0 4px 16px rgba(0,0,0,0.08);
        z-index: 100;
        padding: 16px;
        border-radius: 8px;
      }
      .preview-item { display: flex; align-items: center; margin-bottom: 12px; }
      .preview-item img { width: 48px; height: 48px; object-fit: cover; border-radius: 4px; margin-right: 12px; }
      .preview-info h4 { margin: 0 0 4px 0; font-size: 15px; }
      .view-cart-btn { display: block; margin-top: 10px; text-align: center; background: #927830; color: #fff; padding: 8px 0; border-radius: 4px; text-decoration: none; }
      .account-dropdown {
        display: none;
        position: absolute;
        right: 0;
        top: 40px;
        background: #fff;
        border: 1px solid #e0e0e0;
        box-shadow: 0 4px 16px rgba(0,0,0,0.08);
        z-index: 200;
        border-radius: 8px;
        min-width: 140px;
        padding: 8px 0;
      }
      .account-dropdown a {
        display: block;
        padding: 10px 20px;
        color: #222;
        text-decoration: none;
        font-size: 15px;
        transition: background 0.2s;
      }
      .account-dropdown a:hover {
        background: #f3f3f3;
      }
      #account-icon {
        cursor: pointer;
        position: relative;
      }
      .header-icons { position: relative; }
    </style>
  </head>
  <body>
    <div id="search-overlay">
      <div class="search-bar-area">
        <div class="search-bar-inner">
          <form class="search-bar-form" onsubmit="return false;">
            <span class="material-symbols-outlined">search</span>
            <input type="text" placeholder="Search" autofocus>
            <span id="close-search" class="material-symbols-outlined">close</span>
          </form>
          </div>
          </div>
      <div class="blur-bg"></div>
          </div>

    <div class="top-bar">Da thật - Phong cách thật</div>
    <header class="main-header">
          <div class="logo">
        <div class="logo-row">
          <a href="index.html" style="text-decoration:none; color:inherit;">
            <span>-LeatherForLocal-</span>
            <img src="https://pfst.cf2.poecdn.net/base/image/cbf0eb1018bc86141ca55e6c727c8acb4b84de0df8bff9b70b0f55a8779adf98?w=1024&h=768&pmaid=378107088" height="30px" width="50px" style="margin-left:12px;" />
          </a>
        </div>
        <small>Thời trang da cao cấp</small>
            </div>
      <nav>
        <a href="product.html" id="nav-all">Tất cả</a>
        <a href="product.html?category=new" id="nav-new">Sản phẩm mới</a>
        <a href="product.html?category=balo" id="nav-balo">Balo da</a>
        <a href="product.html?category=thoitrang" id="nav-thoitrang">Thời trang da</a>
        <a href="product.html?category=phukien" id="nav-phukien">Phụ kiện da</a>
      </nav>
      <div class="header-icons">
        <span class="material-symbols-outlined" id="search-icon">search</span>
        <span class="material-symbols-outlined" id="account-icon">account_circle</span>
        <div class="account-dropdown" id="account-dropdown">
          <a href="DangNhap.html">Đăng nhập</a>
          <a href="DangKi.html">Đăng ký</a>
        </div>
        <span class="material-symbols-outlined">bookmark</span>
        <div class="cart-icon-container">
          <span class="material-symbols-outlined" id="cart-icon">shopping_cart</span>
          <div class="shopping-bag-preview" id="shopping-bag-preview"></div>
        </div>
          </div>
        </header>

    <div class="breadcrumb">
      <a href="index.html">Trang chủ</a> &gt; <span id="breadcrumb-category">Tất cả sản phẩm</span>
    </div>

    <div class="product-container">
      <!-- Filter Section -->
      <div class="filter-section">
        <h2>Bộ lọc</h2>
        
        <div class="filter-group">
          <div class="filter-header">
            <span>Danh mục</span>
            <span class="material-symbols-outlined">expand_more</span>
          </div>
          <div class="filter-options">
            <label><input type="checkbox" name="category" value="all" checked> Tất cả</label>
            <label><input type="checkbox" name="category" value="balo"> Balo da</label>
            <label><input type="checkbox" name="category" value="thoitrang"> Thời trang da</label>
            <label><input type="checkbox" name="category" value="phukien"> Phụ kiện da</label>
          </div>
          </div>

        <div class="filter-group">
          <div class="filter-header">
            <span>Giá</span>
            <span class="material-symbols-outlined">expand_more</span>
          </div>
          <div class="filter-options">
            <label><input type="checkbox" name="price" value="0-200000"> Dưới 200.000đ</label>
            <label><input type="checkbox" name="price" value="200000-500000"> 200.000đ - 500.000đ</label>
            <label><input type="checkbox" name="price" value="500000-1000000"> 500.000đ - 1.000.000đ</label>
            <label><input type="checkbox" name="price" value="1000000+"> Trên 1.000.000đ</label>
          </div>
        </div>

        <div class="filter-group">
          <div class="filter-header">
            <span>Màu sắc</span>
            <span class="material-symbols-outlined">expand_more</span>
          </div>
          <div class="filter-options color-options">
            <label class="color-option" style="background-color: #000;"></label>
            <label class="color-option" style="background-color: #964B00;"></label>
            <label class="color-option" style="background-color: #A52A2A;"></label>
            <label class="color-option" style="background-color: #D2B48C;"></label>
            <label class="color-option" style="background-color: #808080;"></label>
          </div>
        </div>

        <div class="filter-group">
          <div class="filter-header">
            <span>Chất liệu</span>
            <span class="material-symbols-outlined">expand_more</span>
          </div>
          <div class="filter-options">
            <label><input type="checkbox" name="material" value="da-bo"> Da bò</label>
            <label><input type="checkbox" name="material" value="da-ca-sau"> Da cá sấu</label>
            <label><input type="checkbox" name="material" value="da-de"> Da dê</label>
            <label><input type="checkbox" name="material" value="da-tong-hop"> Da tổng hợp</label>
              </div>
            </div>

        <div class="filter-group">
          <div class="filter-header">
            <span>Thương hiệu</span>
            <span class="material-symbols-outlined">expand_more</span>
          </div>
          <div class="filter-options">
            <label><input type="checkbox" name="brand" value="leatherforlocal"> LeatherForLocal</label>
            <label><input type="checkbox" name="brand" value="gento"> Gento</label>
            <label><input type="checkbox" name="brand" value="karan"> Karan</label>
          </div>
                </div>

        <button class="apply-filter">Áp dụng</button>
              </div>

      <!-- Product Grid -->
      <div class="product-grid-section">
        <div class="product-grid-header">
          <h1 id="product-category-title">Tất cả sản phẩm</h1>
          <div class="product-sort">
            <span>Sắp xếp:</span>
            <select id="sort-options">
              <option value="newest">Mới nhất</option>
              <option value="price-asc">Giá tăng dần</option>
              <option value="price-desc">Giá giảm dần</option>
              <option value="bestseller">Bán chạy nhất</option>
            </select>
          </div>
        </div>

        <div class="product-grid" id="product-grid">
          <!-- Products will be dynamically loaded here -->
        </div>

        <div class="pagination">
          <a href="#" class="active">1</a>
          <a href="#">2</a>
          <a href="#">3</a>
          <a href="#">4</a>
          <a href="#">&raquo;</a>
        </div>
                </div>
              </div>

    <footer>
      <div class="footer-top">
        <div class="footer-newsletter">
          <p>Tham gia cộng đồng để nhận ưu đãi khủng</p>
          <form>
            <input type="email" placeholder="Nhập số điện thoại hoặc email của bạn" required>
            <button>&rarr;</button>
          </form>
          <small>Bạn sẽ đồng ý cung cấp thông tin khi nhập email hoặc số điện thoại</small>
            </div>
        <div class="footer-links">
          <div>
            <h4>About leatherforlocal</h4>
            <ul>
              <li>Balo da</li>
              <li>Thời trang da</li>
              <li>Phụ kiện</li>
              <li>Liên hệ</li>
              <li>Địa chỉ: HCM</li>
              <li>Copyright Notice</li>
            </ul>
          </div>
          <div>
            <h4>Tư vấn và hỗ trợ</h4>
            <ul>
              <li>Cách đặt và mua hàng</li>
              <li>Đổi trả hàng</li>
              <li>Câu hỏi thường gặp</li>
            </ul>
                </div>
          <div>
            <h4>Tham gia cộng đồng</h4>
            <ul>
              <li>LFL group</li>
            </ul>
          </div>
        </div>
                </div>

      <div class="footer-bottom">
        <div class="footer-social">
          <span class="icon ig"><img src="https://img.freepik.com/premium-vector/black-square-social-media-logo_197792-3367.jpg?ga=GA1.1.858237879.1747484975&semt=ais_hybrid&w=740" alt="Instagram" width="22" height="22"></span>
          <span class="icon fb"><img src="https://img.freepik.com/premium-vector/facebook_628407-1653.jpg?ga=GA1.1.858237879.1747484975&semt=ais_hybrid&w=740" alt="Facebook" width="22" height="22"></span>
          <span class="icon yt"><img src="https://img.freepik.com/premium-vector/youtube-square-logo-vector-black-white_667864-109.jpg?ga=GA1.1.858237879.1747484975&semt=ais_hybrid&w=740" alt="YouTube" width="22" height="22"></span>
          <span class="icon tiktok"><img src="https://img.freepik.com/premium-photo/tiktok-application-logo-3d-rendering-white-background_41204-19938.jpg?ga=GA1.1.858237879.1747484975&semt=ais_hybrid&w=740" alt="TikTok" width="22" height="22"></span>
              </div>
        <div class="footer-copyright">
          <span>&copy; 2025 LEATHERFORLOCAL. All Rights Reserved.</span>
            </div>
          </div>
    </footer>

    <script>
      // Sample product data (in a real application, this would come from a database)
      const products = [
        {
          id: 'ao-da-nam-biker-am22',
          name: 'Áo Da Nam Biker AM22',
          category: 'thoitrang',
          type: 'biker',
          price: 500000,
          image: 'https://images.unsplash.com/photo-1675877879221-871aa9f7c314?q=80&w=1964&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D  ',
          description: 'Áo khoác da nam biker AM22 được thiết kế với phong cách biker đậm chất, mang đến vẻ nam tính và cá tính cho người mặc.',
          isNew: true,
          isBestseller: true
        },
        {
          id: 'balo-da-lt223',
          name: 'Balo da LT223',
          category: 'balo',
          type: 'thoitrang',
          price: 230000,
          image: 'https://images.unsplash.com/photo-1622560481156-01fc7e1693e6?w=500&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8bGVhdGhlciUyMGJhY2twYWNrfGVufDB8fDB8fHww',
          description: 'Balo da đơn giản',
          isNew: true,
          isBestseller: true
        },
        {
          id: 'tui-deo-cheo-lt33',
          name: 'Túi đeo chéo LT33',
          category: 'phukien',
          type: 'tuideocheo',
          price: 220000,
          image: 'https://www.gento.vn/wp-content/uploads/2024/08/tui-bao-tu-nam-1-600x600.jpg',
          description: 'Túi đeo chéo',
          isNew: false,
          isBestseller: false
        },
        {
          id: 'balo-lt224',
          name: 'Balo LT224',
          category: 'balo',
          type: 'codien',
          price: 200000,
          image: 'https://www.gento.vn/wp-content/uploads/2023/08/balo-nam-da-bo-hang-hieu-Gento-B3525-600x600.jpg',
          description: 'Balo cổ điển',
          isNew: false,
          isBestseller: false
        },
        {
          id: 'balo-da-lt227',
          name: 'Balo da LT227',
          category: 'balo',
          type: 'that',
          price: 390000,
          image: 'https://product.hstatic.net/1000397717/product/o1cn019au8xo1umacueurfz___2759306023-0-cib_706a048f31084e47bc2b7db3b28d5c62_grande.jpeg',
          description: 'Balo da mới',
          isNew: true,
          isBestseller: false
        },
        {
          id: 'balo-da-lt228',
          name: 'Balo da LT228',
          category: 'balo',
          type: 'dulich',
          price: 330000,
          image: 'https://product.hstatic.net/1000397717/product/thumbnail_6f06d3aa97354138a2e17a04f62890cd_grande.jpg',
          description: 'Balo da mới',
          isNew: true,
          isBestseller: false
        },
        {
          id: 'balo-da-bo-c2',
          name: 'Balo da bò C2',
          category: 'balo',
          type: 'caocap',
          price: 330000,
          image: 'https://www.gento.vn/wp-content/uploads/2024/08/balo-da-bo-1.jpg',
          description: 'Balo da bò cao cấp',
          isNew: true,
          isBestseller: true
        },
        {
          id: 'balo-da-lt222',
          name: 'Balo da LT222',
          category: 'balo',
          type: 'thucong',
          price: 370000,
          image: 'https://www.gento.vn/wp-content/uploads/2022/06/Balo-nam-da-that-cao-cap-Gento-B3141-600x600.jpg',
          description: 'Balo da thủ công',
          isNew: false,
          isBestseller: false
        },
        {
          id: 'ao-da-bo-nam-racer',
          name: 'Áo Da Bò Nam Racer',
          category: 'thoitrang',
          type: 'biker',
          price: 250000,
          image: 'https://product.hstatic.net/200000366789/product/am2308__18_-1_4f4a3f07dee54931b308886675bc5678_large.jpg',
          description: 'Áo Da Bò Nam Racer',
          isNew: false,
          isBestseller: false
        },
        {
          id: 'tui-dung-chia-khoa',
          name: 'Túi đựng chìa khóa',
          category: 'phukien',
          type: 'hopchiakhoa',
          price: 150000,
          image: 'https://www.gento.vn/wp-content/uploads/2023/11/moc-chia-khoa-da-ca-sau2-600x600.jpg',
          description: 'Túi đựng chìa khóa',
          isNew: false,
          isBestseller: false
        },
        {
          id: 'day-da-dong-ho-a2',
          name: 'Dây da đồng hồ A2',
          category: 'phukien',
          type: 'daydongho',
          price: 100000,
          image: 'https://www.gento.vn/wp-content/uploads/2022/09/day-da-dong-ho-cao-cap1-600x600.jpg',
          description: 'Dây da đồng hồ A2',
          isNew: false,
          isBestseller: true
        }
      ];

      // Function to get URL parameters
      function getUrlParams() {
        const params = new URLSearchParams(window.location.search);
        return {
          category: params.get('category'),
          type: params.get('type'),
          filter: params.get('filter'),
          id: params.get('id')
        };
      }

      // Function to filter products based on URL parameters
      function filterProducts() {
        const params = getUrlParams();
        let filteredProducts = [...products];
        
        // Filter by specific product ID
        if (params.id) {
          filteredProducts = filteredProducts.filter(product => product.id === params.id);
          return filteredProducts;
        }
        
        // Filter by category
        if (params.category) {
          if (params.category === 'new') {
            filteredProducts = filteredProducts.filter(product => product.isNew);
          } else {
            filteredProducts = filteredProducts.filter(product => product.category === params.category);
          }
        }
        
        // Filter by type if category is specified
        if (params.type && params.category) {
          filteredProducts = filteredProducts.filter(product => product.type === params.type);
        }
        
        // Filter by special filters
        if (params.filter) {
          switch (params.filter) {
            case 'bestseller':
              filteredProducts = filteredProducts.filter(product => product.isBestseller);
              break;
            case 'new':
              filteredProducts = filteredProducts.filter(product => product.isNew);
              break;
            // Add more filter cases as needed
          }
        }
        
        return filteredProducts;
      }

      // Function to update the page title and breadcrumb based on filters
      function updatePageTitle() {
        const params = getUrlParams();
        let title = 'Tất cả sản phẩm';
        
        if (params.id) {
          const product = products.find(p => p.id === params.id);
          if (product) {
            title = product.name;
          }
        } else if (params.category) {
          switch (params.category) {
            case 'balo':
              title = 'Balo da';
              break;
            case 'thoitrang':
              title = 'Thời trang da';
              break;
            case 'phukien':
              title = 'Phụ kiện da';
              break;
            case 'new':
              title = 'Sản phẩm mới';
              break;
          }
          
          // Add type to title if specified
          if (params.type) {
            switch (params.type) {
              case 'that':
                title += ' - Da thật';
                break;
              case 'dulich':
                title += ' - Du lịch';
                break;
              case 'biker':
                title += ' - Biker';
                break;
              // Add more types as needed
            }
          }
        } else if (params.filter) {
          switch (params.filter) {
            case 'bestseller':
              title = 'Sản phẩm bán chạy';
              break;
            case 'new':
              title = 'Sản phẩm mới';
              break;
            // Add more filter cases as needed
          }
        }
        
        document.getElementById('product-category-title').textContent = title;
        document.getElementById('breadcrumb-category').textContent = title;
        document.title = `LEATHERFORLOCAL - ${title}`;
        
        // Highlight the active navigation link
        const navLinks = document.querySelectorAll('nav a');
        navLinks.forEach(link => link.classList.remove('active-link'));
        
        if (params.category) {
          const navLink = document.getElementById(`nav-${params.category}`);
          if (navLink) {
            navLink.classList.add('active-link');
          } else {
            document.getElementById('nav-all').classList.add('active-link');
          }
        } else {
          document.getElementById('nav-all').classList.add('active-link');
        }
      }

      // Function to render products
      function renderProducts(products) {
        const productGrid = document.getElementById('product-grid');
        productGrid.innerHTML = '';
        
        if (products.length === 0) {
          productGrid.innerHTML = '<div class="no-products">Không tìm thấy sản phẩm phù hợp</div>';
          return;
        }
        
        products.forEach(product => {
          const productCard = document.createElement('div');
          productCard.className = 'product-card';
          
          productCard.innerHTML = `
            <div class="product-image">
              <img src="${product.image}" alt="${product.name}">
              ${product.isNew ? '<span class="product-badge new">Mới</span>' : ''}
              ${product.isBestseller ? '<span class="product-badge bestseller">Bán chạy</span>' : ''}
              <div class="product-actions">
                <button class="action-btn view-btn" data-product-id="${product.id}">
                  <span class="material-symbols-outlined">visibility</span>
                </button>
                <button class="action-btn cart-btn" data-product-id="${product.id}">
                  <span class="material-symbols-outlined">shopping_cart</span>
                </button>
                <button class="action-btn wishlist-btn" data-product-id="${product.id}">
                  <span class="material-symbols-outlined">favorite</span>
                </button>
              </div>
            </div>
            <div class="product-info">
              <h3>${product.name}</h3>
              <p>${product.description}</p>
              <div class="product-price">${product.price.toLocaleString('vi-VN')} đ</div>
            </div>
          `;
          
          productGrid.appendChild(productCard);
        });

        // Add event listeners for the action buttons
        document.querySelectorAll('.view-btn').forEach(btn => {
          btn.addEventListener('click', function() {
            const productId = this.getAttribute('data-product-id');
            window.location.href = `productOrder.html?id=${productId}`;
          });
        });

        document.querySelectorAll('.cart-btn').forEach(btn => {
          btn.addEventListener('click', function() {
            const productId = this.getAttribute('data-product-id');
            const product = products.find(p => p.id === productId);
            if (product) {
              addToCart(product);
            }
          });
        });

        document.querySelectorAll('.wishlist-btn').forEach(btn => {
          btn.addEventListener('click', function() {
            const productId = this.getAttribute('data-product-id');
            const product = products.find(p => p.id === productId);
            if (product) {
              addToWishlist(product);
            }
          });
        });
      }

      // Add to cart functionality
      function addToCart(product) {
        // Get existing cart items from localStorage
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        
        // Check if product already exists in cart
        const existingItem = cart.find(item => item.id === product.id);
        
        if (existingItem) {
          existingItem.quantity += 1;
        } else {
          cart.push({
            id: product.id,
            name: product.name,
            price: product.price,
            image: product.image,
            quantity: 1
          });
        }
        
        // Save updated cart to localStorage
        localStorage.setItem('cart', JSON.stringify(cart));
        
        // Show success message
        alert(`Đã thêm ${product.name} vào giỏ hàng!`);
      }

      // Add to wishlist functionality
      function addToWishlist(product) {
        // Get existing wishlist items from localStorage
        let wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
        
        // Check if product already exists in wishlist
        const existingItem = wishlist.find(item => item.id === product.id);
        
        if (!existingItem) {
          wishlist.push({
            id: product.id,
            name: product.name,
            price: product.price,
            image: product.image
          });
          
          // Save updated wishlist to localStorage
          localStorage.setItem('wishlist', JSON.stringify(wishlist));
          
          // Show success message
          alert(`Đã thêm ${product.name} vào yêu thích!`);
        } else {
          alert('Sản phẩm đã có trong danh sách yêu thích!');
        }
      }

      // Function to handle category filter checkboxes
      function handleCategoryFilters() {
        const categoryCheckboxes = document.querySelectorAll('input[name="category"]');
        const applyFilterBtn = document.querySelector('.apply-filter');
        
        // Add event listener to apply filter button
        applyFilterBtn.addEventListener('click', function() {
          const selectedCategories = Array.from(categoryCheckboxes)
            .filter(checkbox => checkbox.checked)
            .map(checkbox => checkbox.value);
          
          let filteredProducts = [...products];
          
          // If "all" is selected or no categories are selected, show all products
          if (selectedCategories.includes('all') || selectedCategories.length === 0) {
            filteredProducts = products;
          } else {
            // Filter products based on selected categories
            filteredProducts = products.filter(product => 
              selectedCategories.includes(product.category)
            );
          }
          
          // Update URL with selected categories
          const params = new URLSearchParams(window.location.search);
          if (selectedCategories.length > 0 && !selectedCategories.includes('all')) {
            params.set('category', selectedCategories.join(','));
          } else {
            params.delete('category');
          }
          window.history.replaceState({}, '', `${window.location.pathname}?${params}`);
          
          // Update page title and render filtered products
          updatePageTitle();
          renderProducts(filteredProducts);
        });
        
        // Handle checkbox interactions
        categoryCheckboxes.forEach(checkbox => {
          checkbox.addEventListener('change', function() {
            if (this.value === 'all' && this.checked) {
              // If "all" is checked, uncheck other checkboxes
              categoryCheckboxes.forEach(cb => {
                if (cb !== this) cb.checked = false;
              });
            } else if (this.checked) {
              // If a specific category is checked, uncheck "all"
              const allCheckbox = document.querySelector('input[name="category"][value="all"]');
              if (allCheckbox) allCheckbox.checked = false;
            }
          });
        });
      }

      // Initialize the page
      document.addEventListener('DOMContentLoaded', function() {
        updatePageTitle();
        const filteredProducts = filterProducts();
        renderProducts(filteredProducts);
        handleCategoryFilters();
        
        // Add event listeners for filter toggles
        const filterHeaders = document.querySelectorAll('.filter-header');
        filterHeaders.forEach(header => {
          header.addEventListener('click', function() {
            const options = this.nextElementSibling;
            options.style.display = options.style.display === 'block' ? 'none' : 'block';
            const icon = this.querySelector('.material-symbols-outlined');
            icon.textContent = options.style.display === 'block' ? 'expand_less' : 'expand_more';
          });
        });
        
        // Initialize filter groups as closed
        document.querySelectorAll('.filter-options').forEach(options => {
          options.style.display = 'none';
        });
        
        // Add event listener for sort options
        document.getElementById('sort-options').addEventListener('change', function() {
          let sortedProducts = filterProducts();
          
          switch (this.value) {
            case 'newest':
              // No sorting needed, products are already sorted by newest
              break;
            case 'price-asc':
              sortedProducts.sort((a, b) => a.price - b.price);
              break;
            case 'price-desc':
              sortedProducts.sort((a, b) => b.price - a.price);
              break;
            case 'bestseller':
              sortedProducts.sort((a, b) => (b.isBestseller ? 1 : 0) - (a.isBestseller ? 1 : 0));
              break;
          }
          
          renderProducts(sortedProducts);
        });

        const cartIcon = document.getElementById('cart-icon');
        const shoppingBagPreview = document.getElementById('shopping-bag-preview');
        let hideTimeout;

        function renderShoppingBagPreview() {
          const cart = JSON.parse(localStorage.getItem('cart')) || [];
          // Only show Áo Da Nam Biker AM22
          const filtered = cart.filter(item => item.id === 'ao-da-nam-biker-am22');
          if (filtered.length === 0) {
            shoppingBagPreview.innerHTML = '<div class="empty-cart">Giỏ hàng của bạn đang trống.</div>';
            return;
          }
          shoppingBagPreview.innerHTML = filtered.map(item => `
            <div class="preview-item">
              <img src="${item.image}" alt="${item.name}">
              <div class="preview-info">
                <h4>${item.name}</h4>
                <p>${item.price.toLocaleString('vi-VN')} đ</p>
                <p>Số lượng: ${item.quantity}</p>
              </div>
            </div>
          `).join('') + `<a href="cart.html" class="view-cart-btn">Xem giỏ hàng</a>`;
        }

        cartIcon.addEventListener('mouseenter', function() {
          clearTimeout(hideTimeout);
          renderShoppingBagPreview();
          shoppingBagPreview.style.display = 'block';
        });
        cartIcon.addEventListener('mouseleave', function() {
          hideTimeout = setTimeout(() => {
            shoppingBagPreview.style.display = 'none';
          }, 500); // Increased delay to 500ms
        });
        shoppingBagPreview.addEventListener('mouseenter', function() {
          clearTimeout(hideTimeout);
          shoppingBagPreview.style.display = 'block';
        });
        shoppingBagPreview.addEventListener('mouseleave', function() {
          hideTimeout = setTimeout(() => {
            shoppingBagPreview.style.display = 'none';
          }, 500); // Increased delay to 500ms
        });

        const accountIcon = document.getElementById('account-icon');
        const accountDropdown = document.getElementById('account-dropdown');
        accountIcon.addEventListener('click', function(e) {
          e.stopPropagation();
          accountDropdown.style.display = accountDropdown.style.display === 'block' ? 'none' : 'block';
        });
        document.addEventListener('click', function() {
          accountDropdown.style.display = 'none';
        });
        accountDropdown.addEventListener('click', function(e) {
          e.stopPropagation();
        });
      });
    </script>
  </body>
</html>